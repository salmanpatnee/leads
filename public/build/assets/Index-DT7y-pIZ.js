import{d as le,A as v,c as H,a as f,e as a,u as t,h as se,w as s,g as m,b as o,o as d,z as I,i as r,j as y,x as oe,F as A,B as T,t as i,C as U,l as re,D as N}from"./app-DOFZdwai.js";import{_ as M}from"./index-B9tr3Uuv.js";import{S as B,_ as K,a as P,b as W,c as Z,d as F,e as ne,f as de,g as D,h as _,i as ie,j as g,C as ue,k as fe}from"./Pagination.vue_vue_type_script_setup_true_lang-Cp4TUx9E.js";import{_ as j}from"./Input.vue_vue_type_script_setup_true_lang-B_M5STyr.js";import{_ as O,E as me}from"./index-CsWd0uUn.js";import{_ as ce}from"./AppLayout.vue_vue_type_script_setup_true_lang-nUV1OE9-.js";import{X as pe}from"./x-DvKNaAbS.js";import{c as S}from"./createLucideIcon-BPU0mbXR.js";import{C as R}from"./copy-DtTf51hq.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useForwardPropsEmits-v99UbxFL.js";import"./VisuallyHidden-BkYWB8LF.js";import"./index-Clh7Pr42.js";import"./useForwardExpose-hFGj_875.js";import"./RovingFocusGroup-g3Io_QSa.js";import"./check-C5F6g5D6.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./useFormControl-BW0-pA6Q.js";import"./index-CqmfE78h.js";import"./index-CSEUMRIG.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B54Yg20k.js";const be=S("FileTextIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const ve=S("FlagIcon",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);const ye=S("InboxIcon",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);const X=S("MessageCircleWarningIcon",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const J=S("TriangleAlertIcon",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const G=S("ZapIcon",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),_e={class:"leads-manager relative flex h-full flex-1 flex-col gap-6 p-4 md:p-8"},he={class:"relative"},xe={class:"flex flex-col gap-3 lg:flex-row lg:items-center lg:gap-3"},ke={class:"relative flex-1 lg:min-w-[240px] lg:max-w-[320px]"},we={class:"flex gap-2"},Ce={class:"flex items-center gap-2 lg:ml-auto"},Fe={class:"table-container relative overflow-hidden rounded-xl border border-border bg-card shadow-sm"},Se={class:"overflow-x-auto"},Ve={class:"flex flex-col items-center justify-center gap-3 text-muted-foreground"},$e={class:"rounded-full bg-muted p-4"},Ae={class:"space-y-1"},Me={class:"font-body text-base font-semibold text-foreground"},ze={class:"font-body text-sm"},Ie={class:"flex items-center gap-2"},Te={class:"flex h-9 w-9 shrink-0 items-center justify-center rounded-lg bg-primary/10 dark:bg-primary/20"},Ne={class:"truncate text-sm font-body text-muted-foreground"},De={class:"flex items-center gap-2"},je={key:0,class:"flag-badge-container"},Le=["onClick","aria-label"],qe=["onClick","aria-label"],Ee={key:2,class:"flag-menu absolute right-0 top-full mt-2 z-50"},He={class:"bg-card border border-border rounded-lg shadow-lg overflow-hidden"},Ue={class:"p-2"},Be=["onClick","disabled"],Ke={key:0,class:"border-t border-border my-2"},Pe=["onClick","disabled"],We=le({__name:"Index",props:{leads:{},filters:{},sites:{}},setup(Q){const u=Q,h=v(u.filters?.search||""),c=v(u.filters?.site_id||"all"),p=v(u.filters?.status||"all"),x=v(u.filters?.date_from||""),k=v(u.filters?.date_to||""),w=v(null),V=v(new Set),L=H(()=>u.leads.data.length>0),$=H(()=>h.value||c.value&&c.value!=="all"||p.value&&p.value!=="all"||x.value||k.value),C=()=>{const n={};h.value&&(n.search=h.value),c.value&&c.value!=="all"&&(n.site_id=c.value),p.value&&p.value!=="all"&&(n.status=p.value),x.value&&(n.date_from=x.value),k.value&&(n.date_to=k.value),N.get("/leads",n,{preserveState:!0,preserveScroll:!0})},q=()=>{h.value="",c.value="all",p.value="all",x.value="",k.value="",N.get("/leads",{},{preserveState:!1,preserveScroll:!0})},Y=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),ee=n=>{const e=Object.keys(n).find(l=>l.toLowerCase().includes("email"));return e?n[e]:null},te=n=>{switch(n){case"new":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"contacted":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"converted":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"}},z=n=>{switch(n){case"test":return{class:"bg-blue-100 text-blue-700 dark:bg-blue-950/50 dark:text-blue-300",icon:G,label:"Test"};case"fake":return{class:"bg-red-100 text-red-700 dark:bg-red-950/50 dark:text-red-300",icon:J,label:"Fake"};case"spam":return{class:"bg-orange-100 text-orange-700 dark:bg-orange-950/50 dark:text-orange-300",icon:X,label:"Spam"};case"duplicate":return{class:"bg-purple-100 text-purple-700 dark:bg-purple-950/50 dark:text-purple-300",icon:R,label:"Duplicate"};default:return null}},ae=[{value:"test",label:"Test",icon:G},{value:"fake",label:"Fake",icon:J},{value:"spam",label:"Spam",icon:X},{value:"duplicate",label:"Duplicate",icon:R}],E=async(n,e)=>{V.value.add(n.id);try{(await fetch(`/leads/${n.id}/flag`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""},body:JSON.stringify({flag_reason:e})})).ok&&N.reload({only:["leads"],preserveState:!0})}catch(l){console.error("Failed to flag lead:",l)}finally{V.value.delete(n.id),w.value=null}};return(n,e)=>(d(),f(A,null,[a(t(se),{title:"Leads"}),a(ce,null,{default:s(()=>[(d(),m(I("style"),null,{default:s(()=>[...e[5]||(e[5]=[r(" @import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Manrope:wght@400;500;600;700&display=swap'); ",-1)])]),_:1})),o("div",_e,[e[22]||(e[22]=o("div",{class:"pointer-events-none absolute inset-0 opacity-[0.04] dark:opacity-[0.03]",style:{background:`radial-gradient(
            circle at 20% 20%,
            hsl(var(--primary)) 0%,
            transparent 50%
          )`}},null,-1)),e[23]||(e[23]=o("div",{class:"relative flex flex-col gap-4 md:flex-row md:items-start md:justify-between"},[o("div",{class:"space-y-1.5"},[o("h1",{class:"font-display text-3xl font-bold tracking-tight text-foreground md:text-4xl"}," Leads "),o("p",{class:"max-w-2xl font-body text-base text-muted-foreground"}," View and manage leads submitted from your WordPress sites ")])],-1)),o("div",he,[o("div",xe,[o("div",ke,[a(t(B),{class:"absolute left-4 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground","aria-hidden":"true"}),a(t(j),{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=l=>h.value=l),type:"search",placeholder:"Search leads...",class:"h-11 pl-11 font-body shadow-sm",onKeydown:oe(C,["enter"]),"aria-label":"Search leads"},null,8,["modelValue"])]),a(t(K),{modelValue:c.value,"onUpdate:modelValue":[e[1]||(e[1]=l=>c.value=l),C],"aria-label":"Filter by site"},{default:s(()=>[a(t(P),{class:"h-11 w-full font-body shadow-sm lg:w-[180px]"},{default:s(()=>[a(t(W),{placeholder:"All Sites"})]),_:1}),a(t(Z),null,{default:s(()=>[a(t(F),{value:"all"},{default:s(()=>[...e[6]||(e[6]=[r("All Sites",-1)])]),_:1}),(d(!0),f(A,null,T(u.sites,l=>(d(),m(t(F),{key:l.id,value:String(l.id)},{default:s(()=>[r(i(l.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),a(t(K),{modelValue:p.value,"onUpdate:modelValue":[e[2]||(e[2]=l=>p.value=l),C],"aria-label":"Filter by status"},{default:s(()=>[a(t(P),{class:"h-11 w-full font-body shadow-sm lg:w-[180px]"},{default:s(()=>[a(t(W),{placeholder:"All Statuses"})]),_:1}),a(t(Z),null,{default:s(()=>[a(t(F),{value:"all"},{default:s(()=>[...e[7]||(e[7]=[r("All Statuses",-1)])]),_:1}),a(t(F),{value:"new"},{default:s(()=>[...e[8]||(e[8]=[r("New",-1)])]),_:1}),a(t(F),{value:"contacted"},{default:s(()=>[...e[9]||(e[9]=[r("Contacted",-1)])]),_:1}),a(t(F),{value:"converted"},{default:s(()=>[...e[10]||(e[10]=[r("Converted",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o("div",we,[a(t(j),{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=l=>x.value=l),type:"date",placeholder:"From date",class:"h-11 w-full font-body shadow-sm lg:w-[160px]","aria-label":"From date",onChange:C},null,8,["modelValue"]),a(t(j),{modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=l=>k.value=l),type:"date",placeholder:"To date",class:"h-11 w-full font-body shadow-sm lg:w-[160px]","aria-label":"To date",onChange:C},null,8,["modelValue"])]),o("div",Ce,[a(t(M),{variant:"outline",size:"lg",onClick:C,class:"h-11 shadow-sm","aria-label":"Apply filters"},{default:s(()=>[a(t(B),{class:"mr-2 h-4 w-4"}),e[11]||(e[11]=r(" Apply Filters ",-1))]),_:1}),$.value?(d(),m(t(M),{key:0,variant:"ghost",size:"lg",onClick:q,class:"h-11 font-body","aria-label":"Clear all filters"},{default:s(()=>[a(t(pe),{class:"mr-2 h-4 w-4","aria-hidden":"true"}),e[12]||(e[12]=r(" Clear ",-1))]),_:1})):y("",!0)])])]),o("div",Fe,[o("div",Se,[a(t(ne),null,{default:s(()=>[a(t(de),null,{default:s(()=>[a(t(D),{class:"bg-primary hover:bg-primary"},{default:s(()=>[a(t(_),{class:"h-12 font-body font-semibold text-primary-foreground"},{default:s(()=>[...e[13]||(e[13]=[r("Site",-1)])]),_:1}),a(t(_),{class:"h-12 font-body font-semibold text-primary-foreground"},{default:s(()=>[...e[14]||(e[14]=[r("Form Name",-1)])]),_:1}),a(t(_),{class:"h-12 font-body font-semibold text-primary-foreground"},{default:s(()=>[...e[15]||(e[15]=[r("Email",-1)])]),_:1}),a(t(_),{class:"h-12 font-body font-semibold text-primary-foreground"},{default:s(()=>[...e[16]||(e[16]=[r("Status",-1)])]),_:1}),a(t(_),{class:"h-12 font-body font-semibold text-primary-foreground"},{default:s(()=>[...e[17]||(e[17]=[r("Flag",-1)])]),_:1}),a(t(_),{class:"h-12 font-body font-semibold text-primary-foreground"},{default:s(()=>[...e[18]||(e[18]=[r("Submitted",-1)])]),_:1}),a(t(_),{class:"h-12 text-right font-body font-semibold text-primary-foreground"},{default:s(()=>[...e[19]||(e[19]=[r("Actions",-1)])]),_:1})]),_:1})]),_:1}),a(t(ie),null,{default:s(()=>[L.value?y("",!0):(d(),m(t(D),{key:0},{default:s(()=>[a(t(g),{colspan:"7",class:"h-48 text-center",role:"cell"},{default:s(()=>[o("div",Ve,[o("div",$e,[a(t(ye),{class:"h-8 w-8 text-muted-foreground/60","aria-hidden":"true"})]),o("div",Ae,[o("p",Me,i($.value?"No leads found":"No leads yet"),1),o("p",ze,i($.value?"Try adjusting your search filters":"Leads from your WordPress sites will appear here"),1)]),$.value?(d(),m(t(M),{key:0,variant:"outline",size:"sm",onClick:q,class:"mt-2 font-body"},{default:s(()=>[...e[20]||(e[20]=[r(" Clear filters ",-1)])]),_:1})):y("",!0)])]),_:1})]),_:1})),(d(!0),f(A,null,T(u.leads.data,l=>(d(),m(t(D),{key:l.id,class:"group transition-colors hover:bg-muted/30"},{default:s(()=>[a(t(g),{class:"font-body font-medium"},{default:s(()=>[o("div",Ie,[o("div",Te,[a(t(be),{class:"h-4 w-4 text-primary dark:text-primary","aria-hidden":"true"})]),o("span",null,i(l.site.site_name),1)])]),_:2},1024),a(t(g),{class:"font-body text-muted-foreground"},{default:s(()=>[r(i(l.form_name||"N/A"),1)]),_:2},1024),a(t(g),{class:"max-w-xs"},{default:s(()=>[o("div",Ne,i(ee(l.form_data)||"N/A"),1)]),_:2},1024),a(t(g),null,{default:s(()=>[a(t(O),{class:U([te(l.status),"gap-1.5 font-body font-medium capitalize"])},{default:s(()=>[r(i(l.status),1)]),_:2},1032,["class"])]),_:2},1024),a(t(g),{class:"relative"},{default:s(()=>[o("div",De,[l.flag_reason?(d(),f("div",je,[a(t(O),{class:U([z(l.flag_reason)?.class,"gap-1.5 font-body font-medium capitalize flex items-center animate-in fade-in-50 zoom-in-95"])},{default:s(()=>[(d(),m(I(z(l.flag_reason)?.icon),{class:"h-3.5 w-3.5"})),r(" "+i(z(l.flag_reason)?.label),1)]),_:2},1032,["class"]),o("button",{onClick:b=>w.value=w.value===l.id?null:l.id,class:"flag-menu-trigger ml-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Flag options for lead "+l.id},[a(t(ue),{class:"h-3.5 w-3.5 text-muted-foreground"})],8,Le)])):(d(),f("button",{key:1,onClick:b=>w.value=w.value===l.id?null:l.id,class:"flag-button opacity-0 group-hover:opacity-100 transition-opacity p-1.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded","aria-label":"Flag options for lead "+l.id},[a(t(ve),{class:"h-4 w-4 text-muted-foreground"})],8,qe)),w.value===l.id?(d(),f("div",Ee,[o("div",He,[o("div",Ue,[(d(),f(A,null,T(ae,b=>o("button",{key:b.value,onClick:Ze=>E(l,b.value),disabled:V.value.has(l.id),class:"flag-menu-item w-full text-left px-3 py-2 rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2 text-sm"},[(d(),m(I(b.icon),{class:"h-4 w-4"})),r(" "+i(b.label),1)],8,Be)),64)),l.flag_reason?(d(),f("div",Ke)):y("",!0),l.flag_reason?(d(),f("button",{key:1,onClick:b=>E(l,null),disabled:V.value.has(l.id),class:"flag-menu-item w-full text-left px-3 py-2 rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm text-destructive"}," Remove Flag ",8,Pe)):y("",!0)])])])):y("",!0)])]),_:2},1024),a(t(g),{class:"font-body text-sm text-muted-foreground"},{default:s(()=>[r(i(Y(l.submitted_at)),1)]),_:2},1024),a(t(g),{class:"text-right"},{default:s(()=>[a(t(M),{variant:"ghost",size:"sm","as-child":"",class:"h-8 font-body","aria-label":`View lead from ${l.site.site_name}`},{default:s(()=>[a(t(re),{href:`/leads/${l.id}`},{default:s(()=>[a(t(me),{class:"mr-1.5 h-4 w-4","aria-hidden":"true"}),e[21]||(e[21]=r(" View ",-1))]),_:1},8,["href"])]),_:2},1032,["aria-label"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),L.value?(d(),m(fe,{key:0,data:u.leads,"preserve-query":!0},null,8,["data"])):y("",!0)])]),_:1})],64))}}),pt=ge(We,[["__scopeId","data-v-4376eec0"]]);export{pt as default};
