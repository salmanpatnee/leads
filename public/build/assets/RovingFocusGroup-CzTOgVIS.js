import{b as U,a as y,g as h,c as B}from"./VisuallyHidden-C3_DIH2-.js";import{A as m,c as C,Q as D,R as k,d as T,P as G,a6 as L,S as R,M as $,U as V,g as j,o as K,w as _,e as z,u as b,s as Y}from"./app-CGCrkDAk.js";import{S as M,P as H}from"./index-BkvyfrpA.js";import{u as Q}from"./index-ibSaU8ej.js";function J(e){const o=U({dir:m("ltr")});return C(()=>e?.value||o.dir?.value||"ltr")}const P="data-reka-collection-item";function W(e={}){const{key:o="",isProvider:l=!1}=e,t=`${o}CollectionProvider`;let r;if(l){const a=m(new Map);r={collectionRef:m(),itemMap:a},D(t,r)}else r=k(t);const E=(a=!1)=>{const n=r.collectionRef.value;if(!n)return[];const s=Array.from(n.querySelectorAll(`[${P}]`)),d=Array.from(r.itemMap.value.values()).sort((f,p)=>s.indexOf(f.ref)-s.indexOf(p.ref));return a?d:d.filter(f=>f.ref.dataset.disabled!=="")},S=T({name:"CollectionSlot",setup(a,{slots:n}){const{primitiveElement:s,currentElement:c}=y();return $(c,()=>{r.collectionRef.value=c.value}),()=>R(M,{ref:s},n)}}),F=T({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:n,attrs:s}){const{primitiveElement:c,currentElement:d}=y();return G(f=>{if(d.value){const p=L(d.value);r.itemMap.value.set(p,{ref:d.value,value:a.value}),f(()=>r.itemMap.value.delete(p))}}),()=>R(M,{...s,[P]:"",ref:c},n)}}),I=C(()=>Array.from(r.itemMap.value.values())),g=C(()=>r.itemMap.value.size);return{getItems:E,reactiveItems:I,itemMapSize:g,CollectionSlot:S,CollectionItem:F}}const X="rovingFocusGroup.onEntryFocus",Z={bubbles:!1,cancelable:!0},ee={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function te(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ue(e,o,l){const t=te(e.key,l);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return ee[t]}function oe(e,o=!1){const l=h();for(const t of e)if(t===l||(t.focus({preventScroll:o}),h()!==l))return}function ce(e,o){return e.map((l,t)=>e[(o+t)%e.length])}const[de,re]=B("RovingFocusGroup");var ne=T({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(e,{expose:o,emit:l}){const t=e,r=l,{loop:E,orientation:S,dir:F}=V(t),I=J(F),g=Q(t,"currentTabStopId",r,{defaultValue:t.defaultCurrentTabStopId,passive:t.currentTabStopId===void 0}),a=m(!1),n=m(!1),s=m(0),{getItems:c,CollectionSlot:d}=W({isProvider:!0});function f(i){const v=!n.value;if(i.currentTarget&&i.target===i.currentTarget&&v&&!a.value){const A=new CustomEvent(X,Z);if(i.currentTarget.dispatchEvent(A),r("entryFocus",A),!A.defaultPrevented){const w=c().map(u=>u.ref).filter(u=>u.dataset.disabled!==""),x=w.find(u=>u.getAttribute("data-active")===""),O=w.find(u=>u.getAttribute("data-highlighted")===""),q=w.find(u=>u.id===g.value),N=[x,O,q,...w].filter(Boolean);oe(N,t.preventScrollOnEntryFocus)}}n.value=!1}function p(){setTimeout(()=>{n.value=!1},1)}return o({getItems:c}),re({loop:E,dir:I,orientation:S,currentTabStopId:g,onItemFocus:i=>{g.value=i},onItemShiftTab:()=>{a.value=!0},onFocusableItemAdd:()=>{s.value++},onFocusableItemRemove:()=>{s.value--}}),(i,v)=>(K(),j(b(d),null,{default:_(()=>[z(b(H),{tabindex:a.value||s.value===0?-1:0,"data-orientation":b(S),as:i.as,"as-child":i.asChild,dir:b(I),style:{outline:"none"},onMousedown:v[0]||(v[0]=A=>n.value=!0),onMouseup:p,onFocus:f,onBlur:v[1]||(v[1]=A=>a.value=!1)},{default:_(()=>[Y(i.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),fe=ne;export{fe as R,J as a,oe as f,ue as g,de as i,W as u,ce as w};
